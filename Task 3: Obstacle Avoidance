#include <Servo.h>
#include "SR04.h"

const int servoPin = 9;
const int trigPin = 12;
const int echoPin = 13;
int enA = 3;
int DIRA = 5;
int DIRB = 4;

Servo myServo;
SR04 ultraSonicSensor = SR04(echoPin, trigPin);

long distance;

void setup(){
  myServo.attach(servoPin);
  pinMode(trigPin, OUTPUT);
  pinMode(echoPin, INPUT);
  pinMode(enA, OUTPUT);
  pinMode(DIRA, OUTPUT);
  pinMode(DIRB, OUTPUT);
  myServo.write(90);
}

void loop(){
  analogWrite(enA, 150);
  
  //Swap LOW/HIGH depending on setup
  digitalWrite(DIRA, LOW);
  digitalWrite(DIRB, HIGH);
  
  distance = ultraSonicSensor.distance();
  
  if (distance <= 15){
      digitalWrite(enA, LOW);
      myServo.write(75);
      delay(20);
      analogWrite(enA, 150);
      delay(2000);

      digitalWrite(enA, LOW);
      myServo.write(105);
      delay(20);
      analogWrite(enA, 150);
      delay(2000);

      digitalWrite(enA, LOW);
      myServo.write(105);
      delay(20);
      analogWrite(enA, 150);
      delay(2000);

      digitalWrite(enA, LOW);
      myServo.write(75);
      delay(20);
      analogWrite(enA, 150);
      delay(2000);

      digitalWrite(enA, LOW);
      myServo.write(90);
      delay(20);
      analogWrite(enA, 150);
      delay(2000);
      
      
    }
}  
